---
title: "exploratory_analysis"
author: "Samantha Kotkin, and Sophia Mu"
format: html
---

# Loading Libraries
```{r}
library(tidyverse)
library(ggplot2)
library(knitr)
```

# Data Loading

```{r}
Somerville_data <- read.csv("refined_somerville.csv")
```

# Tables

Correlations between Happiness and Life Satisfaction
```{r}
cor.test(Somerville_data$Somerville.Satisfaction.num, Somerville_data$Happiness.num, method = "pearson")
```
We are 95% confident that there is a moderate (r = .40) and positive correlation between Happiness and Life Satisfaction (p = 0.05, indicating that Happiness is associated with Life Satisfaction. This information helped us to decide to use Happiness as our independent variable in our analysis, as Happiness and Life Satisfaction seem to be interchangeable

Looking at Demographic info
```{r}
countFunction <- function(col){
 Somerville_data |>
    group_by({{col}}) |> 
    summarize(count = n()) 
}
selected <- Somerville_data |> select(Age, Gender, Race.Ethnicity, Household.Income)
map(selected, countFunction) |> kable(caption = "Survey Demographic Information, Somerville, MA, 2025", col.names = c("Demographic", "Number of Respondents"))
```

### Exploratory data analyses
```{r}
#seeing total number of participants
Somerville_data |>
  summarize(count = n())
```

After removing missing variables and answers, there are 471 total participants in the 2025 Somerville Happiness Survey. 

According to the below table, the majority of the participants are White. The next highest amount of participants preferred not to answer. There is a large disparity between Black or African American and Two or more races respondees and White respondees. This likely reflects on the population of Somerville. 
```{r}
Somerville_data |>
  group_by(Race.Ethnicity) |>
  summarize(raceCount = n()) |>
  kable(caption = "Survey Respondents Race/Ethnicity Breakdown, Somerville, MA, 2025", col.names = c("Race/Ethnicity", "Number of Respondents"))
```


```{r}
#function pt 2
findingMean <- function(data){
 data |>
  group_by(Race.Ethnicity) |>
  summarize(across(c(Education.Quality.Satisfaction.num, Housing.Condition.Satisfaction.num, Feel.Part.Community.num, Somerville.Satisfaction.num, Happiness.num), mean))
}
```

```{r}
findingMean(Somerville_data) |> kable(caption = "Mean Reported Satisfaction Scores by Race/Ethnicity, Somerville, MA, 2025", col.names = c("Race/Ethnicity", "Mean Education Quality Satisfaction Rating", "Mean Housing Condition Satisfaction Rating", "Mean Community Belonging Rating", "Mean Satisfaction Rating", "Mean Happiness Rating"))
```
This table shows us the average happiness and satisfaction scores across different survey variables for each race. Participants who did not identify their race/ethnicity were on average the least happy with their Education Quality, followed by White participants. Participants with two or more races/ethnicity were on average the least satisfied with their housing. Participants who did not identify their race/ethnicity on average felt the least a part of their community.

```{r}
Somerville_data |>
  group_by(Age) |>
  summarize(meanEduc = mean(Education.Quality.Satisfaction.num)) |> kable(caption = "Mean Reported Satisfaction Scores by Age, Somerville, MA, 2025", col.names = c("Age", "Mean Education Quality Satisfaction Rating"))
```


## Histogram function
```{r}
s_data <- Somerville_data |>
  select(Education.Quality.Satisfaction.num, Housing.Condition.Satisfaction.num, Feel.Part.Community.num, Somerville.Satisfaction.num, Happiness.num)
```

```{r}
histogramFunction <- function(col, label, data){
  data |> 
  ggplot(aes(x = {{col}})) + 
  geom_histogram() +
  labs(x = gsub("[.]", " ", label), y = "Count", title = "Distribution of Satisfaction Ratings Among Somerville \n Happiness Survey Participants, Somerville, MA, 2025")
}
```

```{r}
map2(s_data, colnames(s_data), histogramFunction, Somerville_data)
```
Histogram showing the range of Satisfaction of all participants for each variable. Across all variables, participants were the least satisfied with the quality of each given variable, with ratings in the 4s and 5s. Because of this trend, most of these histograms are skewed left. Education quality satisfaction seems to be more normally distributed, with the majority of the participants rating it a 3. 

```{r}
histogramFunctionAge <- function(col, label, data){
  data |> 
  ggplot(aes(x = {{col}})) + 
  geom_histogram() +
    facet_wrap(vars(Age), scales = "free") + 
  labs(x = gsub("[.]", " ", label), y = "Count", title = "Distribution of Satisfaction Ratings Among Somerville \n Happiness Survey Participants, Somerville, MA, 2025")
}
```

```{r}
map2(s_data, colnames(s_data), histogramFunctionAge, Somerville_data)
```


